<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MED MADAD | Smart Hospital Queue</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase COMPAT -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg, #0f766e, #10b981);
  color: #fff;
  text-align: center;
}

header {
  padding: 20px;
}

.logo {
  font-size: 32px;
  font-weight: bold;
}

.tagline {
  opacity: 0.9;
}

.container {
  max-width: 420px;
  margin: auto;
  background: #ffffff;
  color: #064e3b;
  border-radius: 16px;
  padding: 20px;
}

select, input, button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  font-size: 16px;
}

.card {
  background: #d1fae5;
  border-radius: 12px;
  padding: 16px;
  margin: 10px 0;
}

.token {
  font-size: 48px;
  font-weight: bold;
}

button {
  background: #059669;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

button:hover {
  background: #047857;
}

footer {
  margin-top: 20px;
  font-size: 12px;
  opacity: 0.9;
}
</style>
</head>

<body>

<header>
  <div class="logo">üè• MED MADAD</div>
  <div class="tagline">Smart care ‚Ä¢ Less waiting ‚Ä¢ Better health</div>
</header>

<div class="container">

  <select id="department">
    <option value="gynaecology">Gynaecology</option>
    <option value="medicine">Medicine</option>
    <option value="orthopedic">Orthopedic</option>
    <option value="surgery">Surgery</option>
  </select>

  <div class="card">
    <div>Issued Token</div>
    <div class="token" id="issued">0</div>
  </div>

  <div class="card">
    <div>Now Serving</div>
    <div class="token" id="running">0</div>
  </div>

  <input type="password" id="password" placeholder="Doctor password">
  <input type="number" id="newIssued" placeholder="New issued token">
  <input type="number" id="newRunning" placeholder="New running token">

  <button onclick="updateTokens()">Update Tokens</button>

</div>

<footer>
‚ö†Ô∏è For information only. Please wait for your turn.  
<br>Created by Raj
</footer>

<script>
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "medmadad-2a807.firebaseapp.com",
  projectId: "medmadad-2a807",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let unsubscribe = null;

function listenDepartment() {
  const dept = document.getElementById("department").value;

  if (unsubscribe) unsubscribe();

  const ref = db.collection("departments").doc(dept);
  unsubscribe = ref.onSnapshot(doc => {
    if (!doc.exists) return;
    const d = doc.data();
    document.getElementById("issued").innerText = d.issuedToken;
    document.getElementById("running").innerText = d.runningToken;
  });
}

document.getElementById("department").addEventListener("change", listenDepartment);
listenDepartment();

function updateTokens() {
  const dept = document.getElementById("department").value;
  const pass = document.getElementById("password").value;
  const issued = Number(document.getElementById("newIssued").value);
  const running = Number(document.getElementById("newRunning").value);

  const ref = db.collection("departments").doc(dept);

  ref.get().then(doc => {
    if (doc.data().password !== pass) {
      alert("Wrong password");
      return;
    }

    ref.update({
      issuedToken: issued,
      runningToken: running
    });
  });
}
</script>

</body>
</html>
